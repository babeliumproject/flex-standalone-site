<?xml version="1.0" encoding="utf-8"?>
<common:CustomTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
						  xmlns:s="library://ns.adobe.com/flex/spark"
						  xmlns:mx="library://ns.adobe.com/flex/mx"
						  xmlns:videoPlayer="modules.videoPlayer.*"
						  xmlns:common="view.common.*"
						  title="{resourceManager.getString('myResources','TITLE_VIEW_VIDEO_COMMENT')}"
						  showCloseButton="true"
						  horizontalAlign="center"
						  layout="vertical"
						  creationComplete="onComplete()">

	<fx:Script>
		<![CDATA[
			import model.DataModel;
			
			import modules.videoPlayer.events.VideoPlayerEvent;
			
			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;

			[Bindable]
			private var _streamSource:String=DataModel.getInstance().streamingResourcesPath;
			
			[Bindable]
			private static var _commentSource:String='';

			[Bindable]
			private var _videoPlayerReady:Boolean=false;
			
			public function set videoSource(source:String):void{
				VideoCommentVP.videoSource = source;
			}

			private function onComplete():void
			{
				this.addEventListener(CloseEvent.CLOSE, closeButtonClickHandler);
				setupVideoPlayer();
			}

			private function setupVideoPlayer():void
			{
				VideoCommentVP.addEventListener(VideoPlayerEvent.CONNECTED, onVideoPlayerReady);
			}

			private function onVideoPlayerReady(e:VideoPlayerEvent):void
			{
				_videoPlayerReady=true;
				VideoCommentVP.stopVideo();
				VideoCommentVP.state = VideoPlayerBabelia.PLAY_STATE;
				VideoCommentVP.videoSource=_commentSource;
				VideoCommentVP.controlsEnabled = true;
			}

			private function closeButtonClickHandler(event:Event):void
			{
				VideoCommentVP.stopVideo();
				VideoCommentVP.endVideo();
				PopUpManager.removePopUp(this);
			}
		]]>
	</fx:Script>

	<s:VGroup id="videoPlayerBox">
		<videoPlayer:VideoPlayerBabelia id="VideoCommentVP"
										autoPlay="true"
										skin="white"
										seek="true"
										subtitles="false"
										autoScale="false"
										arrows="false"
										subtitlingControls="false"
										width="400"
										height="{Math.floor(VideoCommentVP.width * 9 / 16)}"
										streamSource="{_streamSource}"
										controlsEnabled="true"/>
	</s:VGroup>
	<mx:Spacer width="20"/>
	<s:Button click="closeButtonClickHandler(event)"/>
</common:CustomTitleWindow>
