<?xml version="1.0" encoding="utf-8"?>
<s:VGroup xmlns:fx="http://ns.adobe.com/mxml/2009"
		  xmlns:s="library://ns.adobe.com/flex/spark"
		  xmlns:mx="library://ns.adobe.com/flex/mx"
		  gap="14">

	<fx:Script>
		<![CDATA[
			import control.URLManager;

			import model.DataModel;

			import mx.events.FlexEvent;

			private var noActionMessage:String='No action was requested.';
			private var activatingMessage:String="Activating account. Please wait...";
			private var successfulActivationMessage:String="Your account has been successfully activated. Redirecting to home...";
			private var wrongActivationMessage:String="A problem occurred while activating your account. Please try again later.";

			[Bindable]
			private var message:String=noActionMessage;

			private var redirectTimer:Timer;

			public function set greetAndRedirect(value:Boolean):void
			{
				if (DataModel.getInstance().accountActivationRetrieved == true)
				{
					if (DataModel.getInstance().accountActivationStatus)
					{
						message=successfulActivationMessage;
						redirectTimer=new Timer(3000, 1);
						redirectTimer.addEventListener(TimerEvent.TIMER, redirectToHomePage);
						redirectTimer.start();
					}
					else
					{
						message=wrongActivationMessage;
					}
					DataModel.getInstance().accountActivationRetrieved=false;
				}
			}

			public function redirectToHomePage(event:TimerEvent):void
			{
				redirectTimer.stop();
				message=noActionMessage;
				//new ViewChangeEvent(ViewChangeEvent.VIEW_HOME_MODULE).dispatch();
				URLManager.getInstance().redirect('/home');
			}
		]]>
	</fx:Script>

	<fx:Binding source="{DataModel.getInstance().accountActivationRetrieved}"
				destination="greetAndRedirect"/>

	<s:Label text="{resourceManager.getString('myResources','ACCOUNT_ACTIVATION')}"
			 styleName="h2"/>
	<mx:HRule width="100%"/>
	<s:Label id="activating"
			 text="{message}"/>
</s:VGroup>
