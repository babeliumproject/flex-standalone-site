<?xml version="1.0" encoding="utf-8"?>

<mx:ProgressBar xmlns:mx="http://www.adobe.com/2006/mxml"
				creationComplete="init()"
				minimum="0" 
				maximum="100" 
				mode="manual" 
				barColor="green" 
				label="Mic Level: 0"
				width="100%"
				height="100%">
				
<mx:Script>
	<![CDATA[
		private var mictimer:Timer=null;
		private var my_mic:Microphone;
		
		private function init():void{
			mictimer=new Timer(20, 0);
			mictimer.addEventListener(TimerEvent.TIMER, onTick);
		}
		
		public function giveMicrophone(mic:Microphone):void{
			my_mic=mic;
			mictimer.start();
		}
		
		private function onTick(event:TimerEvent):void{
			this.setProgress(my_mic.activityLevel, 100);
			this.label="Mic Level:   " +  my_mic.activityLevel;
		}
		
	]]>
</mx:Script>

</mx:ProgressBar>