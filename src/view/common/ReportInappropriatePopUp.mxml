<?xml version="1.0" encoding="utf-8"?>
<skins:CustomTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
						 xmlns:s="library://ns.adobe.com/flex/spark"
						 xmlns:mx="library://ns.adobe.com/flex/mx"
						 title="{resourceManager.getString('myResources','TITLE_REPORT_INAPPROPRIATE')}"
						 xmlns:skins="skins.*"
						 creationComplete="creationCompleteHandler()"
						 xmlns:common="view.common.*">

	<skins:layout>
		<s:VerticalLayout/>
	</skins:layout>

	<fx:Script>
		<![CDATA[
			import events.ExerciseEvent;

			import model.DataModel;

			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;

			import vo.ExerciseReportVO;
			import vo.ExerciseVO;

			private var _exercise:ExerciseVO;

			[Bindable]
			private var _isPrompt:Boolean;

			//The keyCode for ENTER key
			public static const ENTER_KEY:int=13;

			public function creationCompleteHandler():void
			{
				this.addEventListener(KeyboardEvent.KEY_DOWN, checkPressedKey);
				this.addEventListener(CloseEvent.CLOSE, cancelButtonClickHandler);
				//_isPrompt =  reportComboBox.reportInappropriateComboBox.selectedIndex > -1;
			}

			private function checkPressedKey(e:KeyboardEvent):void
			{
				if (e.keyCode == ENTER_KEY)
				{
					reportButtonClickHandler(null);
				}
			}

			public function set exerciseData(exercise:ExerciseVO):void
			{
				if (exercise)
					_exercise=exercise;
			}

			public function get exerciseData():ExerciseVO
			{
				return _exercise;
			}

			public function reportButtonClickHandler(event:Event):void
			{
				if (_exercise && reportComboBox.reportInappropriateComboBox.selectedIndex > -1)
				{
					var report:ExerciseReportVO=new ExerciseReportVO();
					report.exerciseId=_exercise.id;
					report.reason=reportComboBox.reportInappropriateComboBox.selectedItem.toString();
					PopUpManager.removePopUp(this);
					new ExerciseEvent(ExerciseEvent.REPORT_EXERCISE, null, report, null).dispatch();
				}
			}

			public function cancelButtonClickHandler(event:Event):void
			{
				PopUpManager.removePopUp(this);
			}
		]]>
	</fx:Script>

	<s:VGroup>
		<s:Label text="{resourceManager.getString('myResources','MESSAGE_REPORT_INAPPROPRIATE')}"
				 fontSize="16"
				 fontWeight="bold"/>

		<s:HGroup width="100%">
			<mx:Spacer/>
			<mx:Spacer/>
			<s:VGroup>
				<s:Label text="{resourceManager.getString('myResources','MESSAGE_REPORT_SPECIFY_ISSUE')}"/>
				<common:ReportInappropriateComboBox id="reportComboBox"/>
			</s:VGroup>
		</s:HGroup>

		<mx:Spacer/>
		<mx:Spacer/>
	</s:VGroup>
	<mx:HRule width="100%"/>
	<s:HGroup width="100%"
			  horizontalAlign="center"
			  verticalAlign="middle">
		<s:Button label="{resourceManager.getString('myResources','BUTTON_REPORT')}"
				  id="reportButton"
				  click="reportButtonClickHandler(event)"
				  enabled="true"/>
		<s:Button label="{resourceManager.getString('myResources','BUTTON_CANCEL')}"
				  id="cancelButton"
				  click="cancelButtonClickHandler(event)"/>
	</s:HGroup>

</skins:CustomTitleWindow>
