<?xml version="1.0" encoding="utf-8"?>
<skins:CustomTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
						 xmlns:s="library://ns.adobe.com/flex/spark"
						 xmlns:mx="library://ns.adobe.com/flex/mx"
						 xmlns:skins="skins.*"
						 xmlns:common="view.common.*"
						 styleName="reportPopup"
						 title="{resourceManager.getString('myResources','REPORT_INAPPROPRIATE')}"
						 creationComplete="creationCompleteHandler()"
						 autoLayout="true">

	<skins:layout>
		<s:VerticalLayout paddingLeft="10"
						  paddingRight="10"
						  paddingTop="10"
						  paddingBottom="10"/>
	</skins:layout>

	<fx:Script>
		<![CDATA[
			import modules.exercise.event.ExerciseEvent;

			import model.DataModel;

			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;

			import vo.ExerciseReportVO;
			import vo.ExerciseVO;

			private var _exercise:ExerciseVO;

			[Bindable]
			private var _isPrompt:Boolean;

			//The keyCode for ENTER key
			public static const ENTER_KEY:int=13;

			public function creationCompleteHandler():void
			{
				this.addEventListener(KeyboardEvent.KEY_DOWN, checkPressedKey);
				this.addEventListener(CloseEvent.CLOSE, cancelButtonClickHandler);
				//_isPrompt =  reportComboBox.reportInappropriateComboBox.selectedIndex > -1;
			}

			private function checkPressedKey(e:KeyboardEvent):void
			{
				if (e.keyCode == ENTER_KEY)
				{
					reportButtonClickHandler(null);
				}
			}

			public function set exerciseData(exercise:ExerciseVO):void
			{
				if (exercise)
					_exercise=exercise;
			}

			public function get exerciseData():ExerciseVO
			{
				return _exercise;
			}

			public function reportButtonClickHandler(event:Event):void
			{
				if (_exercise && reportComboBox.reportInappropriateComboBox.selectedIndex > -1)
				{
					var report:ExerciseReportVO=new ExerciseReportVO();
					report.exerciseId=_exercise.id;
					report.reason=reportComboBox.reportInappropriateComboBox.selectedItem.toString();
					PopUpManager.removePopUp(this);
					new ExerciseEvent(ExerciseEvent.REPORT_EXERCISE, report).dispatch();
				}
			}

			public function cancelButtonClickHandler(event:Event):void
			{
				PopUpManager.removePopUp(this);
			}
		]]>
	</fx:Script>



	<s:Label text="{resourceManager.getString('myResources','REPORT_SPECIFY_ISSUE')}"
			 styleName="formLabel"/>
	<common:ReportInappropriateComboBox id="reportComboBox"
										paddingLeft="16"/>

	<s:HGroup width="100%"
			  horizontalAlign="center"
			  verticalAlign="middle"
			  paddingTop="20">
		<s:Button label="{resourceManager.getString('myResources','REPORT')}"
				  id="reportButton"
				  styleName="bigBlueButton"
				  click="reportButtonClickHandler(event)"
				  enabled="true"
				  buttonMode="true"/>
		<s:Button label="{resourceManager.getString('myResources','CANCEL')}"
				  id="cancelButton"
				  styleName="bigBlueButton"
				  click="cancelButtonClickHandler(event)"
				  buttonMode="true"/>
	</s:HGroup>

</skins:CustomTitleWindow>
